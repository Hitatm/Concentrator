<!DOCTYPE html>
<html lang="zh-CN">
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>基本信息</title>

    <link href="../../static/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="../../static/bootstrap-3.3.5/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css"/>
    <link href="../../static/upload/buttons.css" rel="stylesheet" type="text/css"/>
    <link href="../../static/upload/default.css" rel="stylesheet" type="text/css"/>
    <link href="../../static/upload/fileinput.min.css" rel="stylesheet" type="text/css"/>
    
    <link rel="stylesheet" type="text/css" media="all" href="../../static/daterangepicker/daterangepicker-bs3.css" />
    <link rel="stylesheet" type="text/css" media="all" href="../../static/daterangepicker/daterangepicker-1.3.7.css" />
    <link href="../../static/daterangepicker/font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet">

<script src="../../static/bootstrap-3.3.5/js/jquery-1.11.3.min.js" type="text/javascript"></script>
<script src="../../static/jquery-ui-bootstrap/assets/js/jquery-ui-1.10.0.custom.min.js" type="text/javascript"></script>
<script src="../../static/bootstrap-3.3.5/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../../static/bootstrap-3.3.5/js/fileinput.min.js" type="text/javascript"></script>
<script src="../../static/upload/fileinput_locale_zh.js" type="text/javascript"></script>

    <script type="text/javascript" src="../../static/daterangepicker/moment.js"></script>
    <script type="text/javascript" src="../../static/daterangepicker/daterangepicker-1.3.7.js"></script>
    
    <style type="text/css">
      .demo { position: relative; }
      .demo i {
        position: absolute; bottom: 10px; right: 24px; top: auto; cursor: pointer;
      }
    </style>

<script type="text/javascript">
        $(document).ready(function (){
                    // 时间插件
                    $('#reportrange span').html(moment().subtract('hours', 6).format('YYYY-MM-DD HH:mm:ss') + ' - ' + moment().format('YYYY-MM-DD HH:mm:ss'));
                    $('#timesrange').val(($('#reportrange span').html()));
                    
                    $('#reportrange').daterangepicker(
                            {
                                maxDate : moment(),
                                dateLimit : {
                                    days : 60
                                },  
                                showDropdowns : true,
                                showWeekNumbers : false,  
                                timePicker : true,  
                                timePickerIncrement : 5,  
                                timePicker12Hour : false,
                                timePickerSeconds :true,  
                                  ranges : {
                  //'最近1小时': [moment().subtract('hours',1), moment()],
                  '今日': [moment().startOf('day'), moment()],
                  '昨日': [moment().subtract('days', 1).startOf('day'), moment().subtract('days', 1).endOf('day')],
                  '最近7日': [moment().subtract('days', 6), moment()],
                  '最近30日': [moment().subtract('days', 29), moment()]
                },
                                opens : 'right', // //日期选择框的弹出位置
                                buttonClasses : [ 'btn btn-default' ],
                                applyClass : 'btn-small btn-primary blue',
                                cancelClass : 'btn-small',
                                format : 'YYYY-MM-DD HH:mm:ss', // 控件中from和to 显示的日期格式
                                separator : ' to ',
                                locale : {
                                          applyLabel : '确定',
                                          cancelLabel : '取消',
                                          fromLabel : '起始时间',
                                          toLabel : '结束时间',
                                          customRangeLabel : '自定义',
                                          daysOfWeek : [ '日', '一', '二', '三', '四', '五', '六' ],
                                          monthNames : [ '一月', '二月', '三月', '四月', '五月', '六月',
                                            '七月', '八月', '九月', '十月', '十一月', '十二月' ],
                                          firstDay : 1
                                }
                            }, function(start, end, label) {//格式化日期显示框                                
                                $('#reportrange span').html(start.format('YYYY-MM-DD HH:mm:ss') + ' - ' + end.format('YYYY-MM-DD HH:mm:ss'));
                                console.log(start.format('YYYY-MM-DD HH:mm:ss'))
                                $('#timesrange').val(($('#reportrange span').html()));
                           });
         
      // 设置日期菜单被选项  --开始--
        var dateOption ;  
        if("${riqi}"=='day') {  
        dateOption = "今日";  
        }else if("${riqi}"=='yday') {  
        dateOption = "昨日";  
        }else if("${riqi}"=='week'){  
        dateOption ="最近7日";  
        }else if("${riqi}"=='month'){  
        dateOption ="最近30日";  
        }else if("${riqi}"=='year'){  
        dateOption ="最近一年";  
        }else{  
        dateOption = "自定义";  
        }  
        $(".daterangepicker").find("li").each(function (){  
        if($(this).hasClass("active")){  
        $(this).removeClass("active");  
        }  
        if(dateOption==$(this).html()){  
        $(this).addClass("active");  

        }  
        }); 
        });

    </script>
</head>
<body>
<br>
<div class="container">
    <h2 class="text-center">数据包基本信息</h2>
</div>
<div>
    <div class="container">
       
        <form enctype="multipart/form-data" method="POST" action="{{url_for('basedata')}}">

                   <h4>请选择时间段:</h4>
            <div class="controls">
                <div id="reportrange" class="pull-left dateRange" >
               
                <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
                <span id="searchDateRange" name="searchDateRange"></span>          
                         <b class="caret"></b>
                         <input type="hidden" id="timesrange" name="field_name"  />
                         
                </div>
                <button type="submit" >提交</button>
            </div>
            <br />
        　</form> 
    </div>  
</div>

<div class="container">
    <form class="form-inline" method="POST" action="{{ url_for('basedata') }}">
  <div class="form-group">
    <label for="proto">协议过滤 : </label>&nbsp;&nbsp;
      <select class="form-control" name="filter_type">&nbsp;&nbsp;
          <option value="all" selected>所&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有</option>
          <option value="ID">节点&nbsp;&nbsp;&nbsp;ID</option>
          <option value="synparentID">同步父节点ID</option>
          <option value="synlevel">同步等级</option>
      </select>&nbsp;&nbsp;
    <input type="text" class="form-control" id="proto" name="value">&nbsp;&nbsp;
  </div>
  <button type="submit" class="btn btn-success">&nbsp;过&nbsp;&nbsp;&nbsp;滤&nbsp;</button>&nbsp;&nbsp;
        <button type="submit" class="btn btn-info cancle">&nbsp;清&nbsp;&nbsp;&nbsp;除&nbsp;</button>
</form>
</div>

<br>
<!-- <div class="bs-example" data-example-id="hoverable-table"> -->
    <table class="table table-hover table-responsive  table-condensed table-striped">
      <thead>
        <tr>
            <th class="text-center">序号</th>
            <th class="text-center">时间</th>
            <th class="text-center">源节点</th>
            <th class="text-center">父节点</th>
            <th class="text-center">节点时间</th>
            <th class="text-center">同步时间</th>
            <th class="text-center">cycletime</th>
            <th class="text-center">cycletimeDirection</th>
            <th class="text-center">电流</th>
            <th class="text-center">cpu能耗</th>
            <th class="text-center">lpm能耗</th>
            <th class="text-center">TX能耗</th>
            <th class="text-center">RX能耗</th>
            <th class="text-center">电压</th>
            <th class="text-left">邻居数</th>
            <th class="text-left">重启标记</th>
            <th class="text-left">信标间隔</th>
            <th class="text-left">路由度量(rtx)</th>
        </tr>
      </thead>
      <tbody>


      {% for pcap in pcaps: %}

      <tr data-toggle="modal" data-target="#myModal">
      <th scope="row" class="text-center" id="id">{{ pcap[0] }}</th>
          <td class="text-nowrap text-center">{{ pcap[16] }}</td>
          <td class="text-center text-nowrap">{{ pcap[1] }}</td>
          <td class="text-left text-nowrap">{{ pcap[2] }}</td>
          <td class="text-center">{{ pcap[15] }}</td>
          <td class="text-center">{{ pcap[8] }}</td>
          <td class="text-center">{{ pcap[13] }}</td>
          <td class="text-center">{{ pcap[14] }}</td>
          <td class="text-center">{{ pcap[17] }}</td>
          <td class="text-center">{{ pcap[3] }}</td>
          <td class="text-center">{{ pcap[4] }}</td>
          <td class="text-center">{{ pcap[6] }}</td>
          <td class="text-center">{{ pcap[5] }}</td>
          <td class="text-center text-nowrap">{{ pcap[7] }}</td>
          <td class="text-left text-nowrap">{{ pcap[10] }}</td>
          <td class="text-left text-nowrap">{{ pcap[12] }}</td>
          <td class="text-left text-nowrap">{{ pcap[9] }}</td>
          <td class="text-left text-nowrap">{{ pcap[11] }}</td>


        </tr>

      {% endfor %}
      </tbody>
    </table>
<!-- </div> -->


<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true" style="width:600px;margin:auto; overflow:auto;word-break:break-all">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">数据包详情</h4>
      </div>
      <div class="modal-body">


           <div class="container-fluid">
            <div class="accordion"  id="accordion">

            <div class="mydata"></div>

          </div>
        </div>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>

<!--清除过滤器-->
<script>
    $(".cancle").click(function(){
        $("input").val(null);
    })
</script>
<!--table点击事件-->
<script>
    var id=0;
    $(function () {
    $("table > tbody > tr").click(function () {
        id=$(this).children('th').eq(0).text();
        $.ajax({
        type: "GET",//jquery 请求方式为 get
        url: "/datashow?id="+id,//jquery 请求URL
        dataType: "html",//jquery接受类型 可以 json js html 等数据
        cache: false,//是否缓存
        success: function(a) {
            $(".mydata").html(a);
        }
    });
    });
})

    function savepdf()
    {
        $.ajax({
        type: "GET",//jquery 请求方式为 get
        url: "/savepdf?id="+id,//jquery 请求URL
        dataType: "html",//jquery接受类型 可以 json js html 等数据
        cache: false,//是否缓存
    });
    }
</script>
<!--自动补全-->
<script>
    var availableTags = ["TCP", "UDP", "ARP", "ICMP", "HTTP", "HTTPS", "DNS", "SSH", "Telnet", "POP3", "SNMP", "SMTP"];
    $("#proto").autocomplete({
        source: availableTags
    });
</script>
<!--模态框拖拽-->
<script>
    $("#myModal").draggable({
    handle: ".modal-header"
});
</script>
</body>
</html>